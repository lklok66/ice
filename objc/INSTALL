======================================================================
Requirements
======================================================================


Operating system
----------------

Ice Touch requires:

- Mac OS X 10.5.4 or later
- iPod touch v2 using software version 2.1.1
- iPhone 3G using software version 2.1


Compiler
--------

Ice Touch requires:

- Xcode 3.1.1
- iPhone SDK for iPhone OS 2.1 (build 9M2517)

These can be downloaded from http://developer.apple.com.


Slice translators
-----------------

You will need the Slice-to-ObjC compiler (slice2objc) and the
Slice-to-C++ compiler (slice2cpp). The distribution includes binaries
for these compilers as well as the source code in case you want to
build them yourself.


mcpp
----

Building the mcpp library is only necessary if you want to build the
Slice translators yourself.

The Slice-to-ObjC and Slice-to-C++ compilers (slice2objc/slice2cpp)
have a dependency on mcpp 2.7 with patch, or mcpp 2.7.1.

We recommend downloading the Ice third-party source archive from

 http://www.zeroc.com/download.html

This archive contains the source distribution for mcpp (along with
other third-party dependencies for the full Ice distribution), as well
as required source patches and configuration instructions.

For more information about this dependency, please refer to the link
below:

 http://mcpp.sourceforge.net


======================================================================
Compilation
======================================================================

Unpack the archive. The sources are contained in the IceTouch-@ver@
subdirectory.

Change the working directory to IceTouch-@ver@:

$ cd IceTouch-@ver@

Edit objc/config/Make.rules to establish your build configuration.
There are three possible build configurations:

* Build for Mac OS X

  - In objc/config/Make.rules, leave COMPILE_FOR_IPHONE and
    COMPILE_FOR_IPHONE_SIMULATOR unset

* Build for the iPhone simulator

  - In objc/config/Make.rules, set COMPILE_FOR_IPHONE_SIMULATOR=YES

* Build for the iPhone or iPod touch

  - In objc/config/Make.rules, set COMPILE_FOR_IPHONE=YES

  - You must set your iPhone Developer Certificate private key
    identifier in the environment variable IDENTIFIER. This
    environment variable must be accessible by the build as well as by
    Xcode to sign the demo and test iPhone binaries.

    One way of doing this is to add IDENTIFIER in your
    ~/.MacOSX/environment.plist as shown below:

<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
	<key>IDENTIFIER</key>
	<string>iPhone Developer: Matthew Newhook</string>
</dict>
</plist>

    You must log out and log in again for the changes to take effect.

In addition, you may also choose to build static libraries:

  - In objc/config/Make.rules, set STATICLIBS=yes

Note that the following restrictions apply if you choose to use static
libraries on the iPhone or the simulator:

  - The iPhone demos will not build without modifications to link the
    static libraries.

  - The test suite cannot be run.

  - Debugging applications does not appear to be possible.

Now you are ready to build Ice Touch:

$ make

This will build the Ice Touch library and tests. If you are building
for Mac OS X, this will also build the demos.

If you are building for iPhone or the iPhone simulator, you should
now use Xcode to build the demos and test suite GUI located in the
following subdirectories:

  - objc/demo/iPhone/chat
  - objc/demo/iPhone/library
  - objc/demo/iPhone/hello
  - objc/test/iPhone/container

After a successful build, you can run the test suite.

Under Mac OS X, run:

$ cd objc
$ python allTests.py

If everything works, you should see lots of "ok" messages. In
case of a failure, the tests abort with "failed".

For the iPhone or iPhone simulator, the test suite runs within an
iPhone application named "Test Suite", located in the directory
objc/test/iPhone/container.


======================================================================
Installation
======================================================================

Simply run "make install" to install Ice Touch in the directory
specified by the "prefix" variable in objc/config/Make.rules.

 - For the Mac OS X build, the libraries are installed into
   <prefix>/lib

 - For the iPhone simulator build, the libraries are installed into
   <prefix>/lib/simulator

 - For the iPhone build, the libraries are installed into
   <prefix>/lib/device

For Mac OS X builds of Ice Touch, the install name of the shared
library is /opt/IceTouch-@mmver@/lib. For iPhone builds, the install
name of the Ice Touch shared libraries is @executable_path/Frameworks.
It is not necessary to modify DYLD_LIBRARY_PATH as long as the shared
library is not moved from this directory.

When compiling Ice Touch programs, you must also make sure to pass the
location of the <prefix>/include directory to the compiler with the -I
option, and the location of the lib directory with the -L option.
