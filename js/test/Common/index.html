<!doctype html>
<html class="no-js" lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Stream Test | Ice for JavaScript</title>
    <style type="text/css">
        .console ul
        { 
            max-height: 300px; 
            min-height: 300px; 
            overflow-y: auto; 
            overflow-x: none;
            word-wrap:break-word;
        }
        ul {list-style-type: none;}
        nav h4 { margin-top: 10px; }
        .side-nav li.current b { color:orange; font-weight: bold; font-style:italic;}
    </style>
  </head>
  <body>
    
    <nav class="top-bar" data-topbar>
        <ul class="title-area">
            <li class="name">
                <h1><a href="#">Ice for JavaScript</a></h1>
            </li>
        </ul>
    </nav>
    
    <section role="main">
        <div class="row">
            <div class="large-2 medium-3 columns">
                <div class="sidebar">
                    <nav>
                        <h4>Test:</h4>
                        <ul class="side-nav tests"></ul>
                    </nav>
                </div>
            </div>
            <div class="large-10 medium-9 columns">
                <h3 id="grid">Output</h3>
                <hr>
                <div class="panel console">
                    <ul><li></li></ul>
                </div>
                <a href="#" class="button" id="run">Run</a>
            </div>
        </div>
    </section>
    <script type="text/javascript">
        var TestCases = {
                "Ice/binding": ["Test.js", "Client.js"],
                "Ice/defaultValue": ["Test.js", "Client.js"],
                "Ice/enums": ["Test.js", "Client.js"],
                "Ice/exceptions": ["Test.js", "Client.js"],
                "Ice/facets": ["Test.js", "Client.js"],
                "Ice/info": ["Test.js", "Client.js"],
                "Ice/inheritance": ["Test.js", "Client.js"],
                "Ice/invoke": ["Test.js", "Client.js"],
                "Ice/objects": ["Test.js", "Client.js"],
                "Ice/optional": ["Test.js", "Client.js"],
                "Ice/promise": ["Client.js"],
                "Ice/proxy": ["Test.js", "Client.js"],
                "Ice/slicing/exceptions": ["Test.js", "Client.js"],
                "Ice/slicing/objects": ["Test.js", "Client.js"],
                "Ice/stream": ["Test.js", "Client.js"]
            };
            
            var current;
            var basePath = "../../";
            for(name in TestCases)
            {
                if(document.location.pathname.indexOf(name) !== -1)
                {
                    current = name;
                    if(name.split("/").length === 3)
                    {
                        basePath = "../../../";
                    }
                }
            }
            
            scripts = [
                basePath + "Common/foundation/js/modernizr.js",
                basePath + "Common/foundation/js/jquery.js",
                basePath + "Common/foundation/js/foundation.min.js",
                basePath + "../lib/Ice.js"
            ];
            
            TestCases[current].forEach(
                function(script){
                    scripts.push(script);
                });
            scripts.push(basePath + "Common/TestSuite.js");
            
            var head = document.getElementsByTagName("head")[0];
            
            var link = document.createElement("link");
            link.rel = "stylesheet";
            link.href = basePath + "Common/foundation/css/foundation.css";
            head.appendChild(link);
            
            function loadScript(i)
            {
                var script = document.createElement("script");
                    script.type = "text/javascript";
                    script.src = scripts[i];
                    if(++i < scripts.length)
                    {
                        script.onload = function()
                        {
                            loadScript(i);
                        };
                        
                        //
                        // There isn't onload event in IE
                        //
                        script.onreadystatechange = function ()
                        {
                            if(this.readyState == 'complete')
                            {
                                loadScript(i);
                            }
                        };
                    }
                    head.appendChild(script);
            }
            loadScript(0);
    </script>
  </body>
</html>
