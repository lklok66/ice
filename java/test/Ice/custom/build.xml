<!--
 **********************************************************************

 Copyright (c) 2003-2006 ZeroC, Inc. All rights reserved.

 This copy of Ice is licensed to you under the terms described in the
 ICE_LICENSE file included in this distribution.

 **********************************************************************
-->

<project name="test_Ice_custom" default="all" basedir=".">

    <!-- set global properties for this build -->
    <property name="top.dir" value="../../.."/>

    <!-- import common definitions -->
    <import file="${top.dir}/config/common.xml"/>

    <target name="generate4" depends="init" unless="java5">
	<!-- Create the output directory for generated code -->
	<mkdir dir="${generated.dir}"/>
	<slice2java outputdir="${generated.dir}">
	    <fileset dir="jdk1.4" includes="Test.ice"/>
	</slice2java>
    </target>

    <target name="generate5" depends="init" if="java5">
	<!-- Create the output directory for generated code -->
	<mkdir dir="${generated.dir}"/>
	<slice2java outputdir="${generated.dir}">
	    <meta value="${java5metadata}"/>
	    <fileset dir="jdk1.5" includes="Test.ice"/>
	</slice2java>
    </target>

    <target name="generate" depends="generate4, generate5"/>

    <target name="compile4" depends="generate" unless="java5">
	<mkdir dir="${class.dir}"/>
	<javac srcdir="${generated.dir}" destdir="${class.dir}"
	    source="${jdk.version}" classpath="${lib.dir}" debug="${debug}"/>
	<javac srcdir="." destdir="${class.dir}" source="${jdk.version}"
	    classpath="${lib.dir}" excludes="generated/**,jdk1.5/**" debug="${debug}"/>
    </target>

    <target name="compile5" depends="generate" if="java5">
        <mkdir dir="${class.dir}"/>
        <javac srcdir="${generated.dir}" destdir="${class.dir}"
	    source="${jdk.version}" classpath="${lib.dir}" debug="${debug}">
	    <compilerarg value="${javac.lint}" compiler="${javac.lint.compiler}"/>
	</javac>
	<javac srcdir="." destdir="${class.dir}" source="${jdk.version}"
	    classpath="${lib.dir}" excludes="generated/**,jdk1.4/**" debug="${debug}">
	    <compilerarg value="${javac.lint}" compiler="${javac.lint.compiler}"/>
	</javac>
    </target>

    <target name="compile" depends="compile4, compile5"/>

    <target name="all" depends="compile"/>

    <target name="clean">
        <delete dir="${generated.dir}"/>
        <delete dir="${class.dir}"/>
    </target>

</project>
