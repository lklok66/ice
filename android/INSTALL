======================================================================
Introduction
======================================================================

This file describes how to build and install Ice for Android from
source code. Note that this distribution also includes a JAR file
containing the Ice for Android run time (android/lib/Ice.jar),
therefore it is not usually necessary to compile the source yourself.
Please refer to the README file for more information on incorporating
Ice for Android into your development environment.

This release of Ice for Android includes a patch for Ice 3.4.1. This
patch (android/patch.txt) resolves several minor issues arising from
differences in the implementation of Android APIs as compared to
desktop Java implementations.

Neither the patch nor the Ice for Java 3.4.1 sources have any
dependencies on Android and can be compiled using any suitable Ice for
Java development environment. However, ZeroC only supports the
development platforms that are also supported by the Android
development tools, namely Mac OS X Leopard, Linux, and Windows.


======================================================================
Requirements
======================================================================


Operating systems
-----------------

Ice for Android has been tested in the emulator using Android 2.1,
2.2, and 2.3, and on the T-Mobile G2 handset using Android 2.2. The
supported development environments are Mac OS X Snow Leopard, Red Hat
Enterprise Linux 5.4, and Windows XP or later.


Java version
------------

Ice for Android requires J2SE 1.5.0 or later.

You can download Java5 and Java6 for Windows and Linux from:

  http://www.oracle.com/technetwork/java/index.html

Make sure to add javac and java to your PATH.


Android SDK
-----------

Ice for Android requires the Android SDK, which is available at the
following link:

  http://developer.android.com


Ice
---

Download a copy of the Ice 3.4.1 source distribution from the ZeroC
web site:

  http://www.zeroc.com/download.html

To save time, we also recommend installing a binary distribution of
Ice 3.4.1. Doing so avoids the need for you to build portions of the
Ice for C++ sources. If you prefer to build Ice for C++ as well, you
will also need to install the third-party libraries required by Ice.


ant
---

The ant utility, version 1.7.0 or later, is necessary for building the
Ice for Android run time JAR file. You can download ant from

  http://ant.apache.org


======================================================================
Compiling the Source
======================================================================

Extract the Ice 3.4.1 source distribution and the Ice for Android
source distribution, as shown below on Unix:

  # On Unix.
  $ tar xzf Ice-3.4.1.tar.gz
  $ tar xzf IceAndroid-0.2.tar.gz

On Windows, use your favorite archive utility to extract the contents
of Ice-3.4.1.zip and IceAndroid-0.2.zip.

Apply the patch to the Ice 3.4.1 sources using the patch utility:

  # On Unix.
  $ cd Ice-3.4.1
  $ patch -p1 < ../IceAndroid-0.2/android/patch.txt

  # On Windows.
  > cd Ice-3.4.1
  > patch --binary -p1 < ..\IceAndroid-0.2\android\patch.txt

See "Applying Patches on Windows" below for important information.

If you are building Ice for C++ from source, please follow the
For more information on building Ice from source, please refer to the
instructions provided in the INSTALL file that is appropriate for your
platform in the top-level subdirectory of the Ice source distribution.

If you have installed an Ice binary distribution, set the ICE_HOME
environment variable to point to your installation directory:

  # On Unix.
  $ export ICE_HOME=/opt/Ice-3.4.1

  # On Windows.
  > set ICE_HOME=C:\Ice-3.4.1

Now you are ready to build the Ice for Android run time JAR file:

  # On Unix.
  $ cd Ice-3.4.1/java
  $ ant ice-jar

  # On Windows.
  > cd Ice-3.4.1\java
  > ant ice-jar

Upon successful completion of the build, the JAR file can be found in
lib/Ice.jar.


======================================================================
Installation
======================================================================

You can copy lib/Ice.jar to the location of your choice.

After installation, add Ice.jar to your CLASSPATH or to your Eclipse
configuration. Refer to the README file for more information.


======================================================================
Applying Patches on Windows
======================================================================

Applying patches requires the "patch" utility. You can download a
Windows executable from the following location:

  http://gnuwin32.sourceforge.net/packages/patch.htm

On Windows Vista or later, UAC can make it difficult to use the patch
utility unless you take extra steps. One solution is to run patch.exe
in a command window that you started with Administrator privileges
(right-click on Command Prompt in the Start menu and choose "Run as
administrator"). If running as administrator is not an option, follow
these recommendations:

  1. Do not install patch.exe in a system-protected directory such as
     C:\Program Files.

  2. Create a manifest file named patch.exe.manifest as explained at
     the link below:

     http://drupal.org/node/99903

     Place the manifest file in the same directory as patch.exe.
