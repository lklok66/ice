<!--
 **********************************************************************

 Copyright (c) 2003-2005 ZeroC, Inc. All rights reserved.

 This copy of Ice-E is licensed to you under the terms described in the
 ICEE_LICENSE file included in this distribution.

 **********************************************************************
-->

<project name="common">

    <!-- get access to env variables globally -->
    <property environment="env"/>

    <dirname property="common.basedir" file="${ant.file.common}"/>
    <property file="${common.basedir}/build.properties"/>

    <available property="wtkfound" file="${WTK}" type="dir"/>
    <fail if="midp" unless="wtkfound" message="WTK directory (${WTK}) does not exist"/>

    <path id="wtklibs">
	<pathelement location="${CLDCLIB}"/>
	<pathelement location="${MIDPLIB}"/>
    </path>

    <property name="WTKLIBS" refid="wtklibs"/>

    <property name="class.dir" value="classes"/>
    <property name="midp.class.dir" value="midp"/>
    <property name="generated.dir" value="generated"/>

    <condition property="hasProguard">
	<available classname="proguard.ant.ProGuardTask" classpath="${env.CLASSPATH}"/>
    </condition>

    <condition property="hasProguardAndMIDP">
	<and>
	    <isset property="hasProguard"/>
	    <isset property="midp"/>
	</and>
    </condition>

    <target name="config-init">
        <!-- Create the time stamp -->
        <tstamp/>

	<property name="slice.dir" value="${top.dir}/slice"/>
	<property name="jdk.lib.dir" value="${top.dir}/jdk/lib" />
	<property name="midp.lib.dir" value="${top.dir}/midp/lib" />
	<taskdef name="slice2javae" classpath="${top.dir}/ant" classname="Slice2JavaETask"/>
	<taskdef name="jadfile" classpath="${top.dir}/ant" classname="JADTask"/>

	<!-- classpath for compiling with JDK -->
	<path id="jdk.classpath">
	    <fileset dir="${jdk.lib.dir}">
		<include name="*.jar"/>
	    </fileset>
	</path>

	<!-- classpath and bootclasspath for compiling with JME -->
	<path id="midp.classpath" location="${midp.lib.dir}"/>
        <path id="midp.bootclasspath" path="${WTKLIBS}"/>
    </target>
    
</project>
